(this["webpackJsonprma-project"]=this["webpackJsonprma-project"]||[]).push([[0],{14:function(e,t,n){},16:function(e,t,n){},17:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(8),c=n.n(i),o=(n(14),n(4)),l=n.n(o),u=n(6),d=n(2),s=n(1);n(16);function h(e,t){var n=r.a.useState(JSON.parse(localStorage.getItem(e))||t),a=Object(s.a)(n,2),i=a[0],c=a[1];return r.a.useEffect((function(){localStorage.setItem(e,JSON.stringify(i))}),[e,i]),[i,c]}function f(e){e.clearRect(0,0,window.innerWidth,window.innerHeight),e.fillStyle="white",e.fillRect(0,0,window.innerWidth,window.innerHeight)}var g=[],p=!1,m=!1;var b=function(){var e=r.a.useState(!1),t=Object(s.a)(e,2),n=t[0],a=t[1],i=function(){var e=h("history",[]),t=Object(s.a)(e,2);return[t[0],t[1],r.a.useRef(null)]}(),c=Object(s.a)(i,3),o=c[0],b=c[1],v=c[2],y=h("redoStack",[]),w=Object(s.a)(y,2),E=w[0],k=w[1],x=r.a.useState(!1),O=Object(s.a)(x,2),j=O[0],S=O[1],C=r.a.useState(!1),L=Object(s.a)(C,2),W=L[0],R=L[1],M=r.a.useState(!1),N=Object(s.a)(M,2),D=N[0],I=N[1],Y=r.a.useState(!1),P=Object(s.a)(Y,2),X=P[0],T=P[1],U=r.a.useState(null),A=Object(s.a)(U,2),H=A[0],J=A[1],B=r.a.useState({x:0,y:0}),F=Object(s.a)(B,2),q=F[0],G=F[1],z=r.a.useState({x:0,y:0}),Z=Object(s.a)(z,2),$=Z[0],K=Z[1],Q=h("tool","pencil"),V=Object(s.a)(Q,2),_=V[0],ee=V[1],te=h("previousTool","pencil"),ne=Object(s.a)(te,2),ae=ne[0],re=ne[1],ie=h("color","#000000"),ce=Object(s.a)(ie,2),oe=ce[0],le=ce[1],ue=h("strokeWidth",5),de=Object(s.a)(ue,2),se=de[0],he=de[1],fe=h("eraserWidth",10),ge=Object(s.a)(fe,2),pe=ge[0],me=ge[1],be=r.a.useState({x:0,y:0}),ve=Object(s.a)(be,2),ye=ve[0],we=ve[1],Ee=r.a.useState({width:300,height:300}),ke=Object(s.a)(Ee,2),xe=ke[0],Oe=ke[1],je=r.a.useState(oe),Se=Object(s.a)(je,2),Ce=Se[0],Le=Se[1];r.a.useEffect((function(){v.current.className="",v.current.classList.add("cursor-"+_)}),[_]),r.a.useEffect((function(){n?document.body.classList.add("loading"):document.body.classList.remove("loading")}),[n]);var We=r.a.createRef(),Re=r.a.createRef(),Me=r.a.useState(),Ne=Object(s.a)(Me,2),De=Ne[0],Ie=Ne[1];function Ye(e){e.dataTransfer.dropEffect="copy",e.preventDefault()}function Pe(e){if(p)switch(e.preventDefault(),e.stopPropagation(),e.key){case"Escape":"keydown"===e.type&&(J(null),p=!1);break;case"Alt":m="keydown"===e.type}}function Xe(e){if(e.type.match(/image.*/)){var t=new Image,n=new FileReader;a(!0),n.readAsDataURL(e),n.onload=function(){t.dataset.base64=n.result,t.src=URL.createObjectURL(e),t.onload=function(){var e=Math.min(xe.width,t.width);J(t),Oe({width:e,height:e*t.height/t.width}),a(!1)}}}}function Te(e,t){f(e);var n=o.length,r=null;if(t>0&&E.length){r=[].concat(Object(d.a)(o),[E[E.length-1]]),b(r),n++;var i=E.slice(0,-1);k(i)}if(t<0&&o.length){var c=[].concat(Object(d.a)(E),Object(d.a)(o.slice(t).reverse()));k(c),r=o.slice(0,t),b(r),n+=t}if(n){var s=0,h=0;Object(d.a)(o).reverse().find((function(e){var t="clear"===e.tool;return t&&h>0&&(s=o.length-h),h++,t})),function(){var t=Object(u.a)(l.a.mark((function t(){var i;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=s;case 1:if(!(i<n)){t.next=7;break}return t.next=4,Ue(e,(r||o)[i]);case 4:i++,t.next=1;break;case 7:a(!1);case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()()}}function Ue(e,t){return Ae.apply(this,arguments)}function Ae(){return(Ae=Object(u.a)(l.a.mark((function e(t,n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("clear"!==n.tool){e.next=4;break}Fe(t),e.next=10;break;case 4:if("image"!==n.tool){e.next=9;break}return e.next=7,Ge(t,n.src,n.dx,n.dy,n.width,n.height);case 7:e.next=10;break;case 9:n.sequence.length&&n.sequence.forEach((function(e){return He(e[0],e[1],t,n.tool,n.color,n.lineWidth)}));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function He(e,t,n,a,r,i){if(n.save(),n.lineJoin="round",n.lineCap="round",n.lineWidth=i||se,n.strokeStyle=r||oe,("eraser"===a||"undefined"===typeof a&&"eraser"===_)&&(n.lineWidth=pe,n.strokeStyle="#ffffff"),n.beginPath(),n.moveTo(e.x,e.y),"spray"===a||"undefined"===typeof a&&"spray"===_){var c=i||se;n.fillStyle=oe,n.rect(t.x,t.y,1,1);for(var o=c;o--;)n.rect(t.x+Math.random()*c-c/2,t.y+Math.random()*c-c/2,1,1),n.fill()}else n.lineTo(t.x,t.y),n.stroke();n.closePath(),n.restore()}function Je(e,t){var n,a,r,i=De.getImageData(e,t,1,1).data;return n=i[0],a=i[1],r=i[2],n=n.toString(16),a=a.toString(16),r=r.toString(16),1===n.length&&(n="0"+n),1===a.length&&(a="0"+a),1===r.length&&(r="0"+r),"#"+n+a+r}function Be(e){!0===j&&!1===W&&(G({x:e.clientX,y:e.clientY}),K({x:e.clientX,y:e.clientY}),function(e,t,n){K({x:t.x,y:++t.y}),g.push([e,t]),He(e,t,n)}(q,$,De)),g.length&&(b([].concat(Object(d.a)(o),[{tool:_,lineWidth:"eraser"===_?pe:se,color:oe,sequence:g}])),k([]),g=[]),S(!1),R(!1)}function Fe(e){e.save(),e.beginPath(),e.globalCompositeOperation="destination-out",e.fillRect(0,0,window.innerWidth,window.innerHeight),e.stroke(),e.restore()}function qe(e,t,n,a,r,i){e.drawImage(t,n,a,r,i)}function Ge(e,t,n,a,r,i){var c=new Image;return c.src=t,new Promise((function(t){c.onload=function(){qe(e,c,n,a,r,i),t()}}))}return r.a.useEffect((function(){p=null!==H}),[H]),r.a.useEffect((function(){var e=v.current,t=e.getContext("2d");Ie(t),e.width=window.innerWidth,e.height=window.innerHeight,document.addEventListener("mousemove",(function(e){we({x:e.clientX,y:e.clientY})})),window.addEventListener("resize",(function(){v.current.width=window.innerWidth,v.current.height=window.innerHeight,Te(v.current.getContext("2d"))})),document.addEventListener("keydown",Pe),document.addEventListener("keyup",Pe),window.addEventListener("dragover",(function(e){e.preventDefault(),e.stopPropagation(),null===H&&T(!0)})),We.current.addEventListener("dragenter",Ye),We.current.addEventListener("dragover",Ye),We.current.addEventListener("dragleave",(function(e){T(!1)})),We.current.addEventListener("drop",(function(e){e.preventDefault(),null===H&&(T(!1),Xe(e.dataTransfer.files[0]))})),Te(t)}),[v]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"debugTooltip",style:{left:ye.x,top:ye.y+20},className:D?"":"hidden "},"x: ",ye.x," y: ",ye.y),r.a.createElement("div",{id:"colorPickerTooltip",style:{left:ye.x,top:ye.y+20,backgroundColor:Ce},className:"colorpicker"===_?"":"hidden "}),r.a.createElement("div",{ref:We,id:"dropZone",className:X?"":"hidden "},r.a.createElement("p",null,"Bild einf\xfcgen")),r.a.createElement("img",{id:"uploadedImage",src:null!==H?H.src:"",className:null===H?"hidden":"",style:{left:null===H?0:ye.x-xe.width/2,top:null===H?0:ye.y-xe.height/2},width:xe.width,height:xe.height,onClick:function(e){null!==H&&(qe(De,H,ye.x-xe.width/2,ye.y-xe.height/2,xe.width,xe.height),b([].concat(Object(d.a)(o),[{tool:"image",src:H.dataset.base64,dx:ye.x-xe.width/2,dy:ye.y-xe.height/2,width:xe.width,height:xe.height}])),k([]),m||J(null))},onWheel:function(e){var t=-.5*e.deltaY,n=xe.width+t;n=Math.max(50,n),Oe({width:n,height:n*e.target.height/e.target.width})}}),r.a.createElement("div",{className:"controls"},r.a.createElement("button",{onClick:function(){return I(!D)}},"Debug"),r.a.createElement("button",{onClick:function(){f(De),b([]),k([])},disabled:!o.length&&!E.length},"New"),r.a.createElement("button",{onClick:function(){Fe(De),b([].concat(Object(d.a)(o),[{tool:"clear"}])),k([])},disabled:!o.length||"clear"===o[o.length-1].tool},"Clear"),r.a.createElement("button",{onClick:function(){a(!0),Te(De,-1)},disabled:!o.length},"Undo"),r.a.createElement("button",{onClick:function(){a(!0),Te(De,1)},disabled:!E.length},"Redo"),r.a.createElement("button",{onClick:function(){!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image.png",n=document.createElement("a");n.setAttribute("href",e),n.setAttribute("download",t),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}(v.current.toDataURL())}},"Export PNG"),r.a.createElement("button",{onClick:function(){Re.current.click()}},"Add Image"),r.a.createElement("form",null,r.a.createElement("input",{ref:Re,id:"uploadButton",type:"file",onChange:function(e){Xe(e.target.files[0])},hidden:!0}),r.a.createElement("label",null,r.a.createElement("input",{type:"radio",value:"pencil",checked:"pencil"===_,onChange:function(e){return ee(e.target.value)}}),"Stift"),r.a.createElement("label",null,r.a.createElement("input",{type:"radio",value:"spray",checked:"spray"===_,onChange:function(e){return ee(e.target.value)}}),"Spr\xfchdose"),r.a.createElement("label",null,r.a.createElement("input",{type:"radio",value:"eraser",checked:"eraser"===_,onChange:function(e){return ee(e.target.value)}}),"Radierer"),r.a.createElement("label",null,r.a.createElement("input",{type:"radio",value:"colorpicker",checked:"colorpicker"===_,onChange:function(e){re(_),ee(e.target.value)}}),"Farbw\xe4hler"),r.a.createElement("label",{hidden:"eraser"===_},r.a.createElement("input",{type:"color",value:oe,onChange:function(e){return le(e.target.value)},disabled:"pencil"!==_&&"spray"!==_}),"Farbe"),r.a.createElement("label",{hidden:"pencil"!==_&&"spray"!==_},r.a.createElement("input",{type:"range",value:se,onChange:function(e){return he(e.target.value)},min:"1",max:"100",step:"1"}),"Gr\xf6\xdfe"),r.a.createElement("label",{hidden:"eraser"!==_},r.a.createElement("input",{type:"range",value:pe,onChange:function(e){return me(e.target.value)},min:"1",max:"150",step:"1"}),"Gr\xf6\xdfe"))),r.a.createElement("canvas",{ref:v,onMouseDown:function(e){0===e.button&&"colorpicker"!==_&&(S(!0),G({x:e.clientX,y:e.clientY}),K({x:e.clientX,y:e.clientY}))},onMouseMove:function(e){"colorpicker"===_&&Le(Je(e.clientX,e.clientY)),!0===j&&(R(!0),G({x:$.x,y:$.y}),K({x:e.clientX,y:e.clientY}),g.push([q,$]),He(q,$,De))},onMouseUp:function(e){if("colorpicker"===_)return le(Je(e.clientX,e.clientY)),void ee(["pencil","spray"].includes(ae)?ae:"pencil");Be(e)},onMouseOut:function(e){Be(e)}}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(b,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},9:function(e,t,n){e.exports=n(17)}},[[9,1,2]]]);
//# sourceMappingURL=main.36df2801.chunk.js.map